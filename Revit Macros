#define DEBUG

string debugFilepath=@"c:\";
			
			// Get the hold of the active document
			Document doc=this.ActiveUIDocument.Document;
			Selection sel=this.ActiveUIDocument.Selection;
			
			TextWriterTraceListener fileListener=null;
			
			GetListener(debugFilepath, ref fileListener);
			
			if(fileListener!=null)
			{
				Debug.Listeners.Add(fileListener);
				Debug.IndentLevel=0;
			}
			
			try
			{	
			}
			catch(Autodesk.Revit.Exceptions.OperationCanceledException)
			{
			}
			catch(Exception ex)
			{
				Debug.WriteLine(string.Format("StackTrace:\n{0}\nMessage:\n{1}",
				                              ex.StackTrace, ex.Message));
				
				TaskDialog.Show("Exception",string.Format("StackTrace:\n{0}\nMessage:\n{1}",
				                                          ex.StackTrace, ex.Message));
			}
			finally
			{
				if(fileListener!=null)
				{
					fileListener.Flush();
					fileListener.Close();
					Debug.Listeners.Remove(fileListener);
				}
				Debug.Flush();
				Debug.Close();
			}

[Conditional("DEBUG")]
		static void GetListener(string filepath,
		                        ref TextWriterTraceListener fileListener)
		{
			fileListener=
				new TextWriterTraceListener(File.Open(filepath,
				                                      FileMode.OpenOrCreate));
		}
